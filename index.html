<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ø®Ø·Ø© Ø§Ù„Ø­ØµÙˆÙ† Ø§Ù„Ø®Ù…Ø³Ø©</title>
  <style>
    body {
      font-family: 'Tahoma', sans-serif;
      background-color: #f7f9fa;
      margin: 0;
      padding: 20px;
      direction: rtl;
    }
    h1, h2 {
      color: #2c3e50;
    }
    .container {
      max-width: 600px;
      margin: auto;
      background-color: #fff;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    label {
      display: block;
      margin-top: 15px;
      font-weight: bold;
    }
    input, select {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }
    .output {
      margin-top: 25px;
      background-color: #e8f6f3;
      padding: 15px;
      border-radius: 8px;
    }
    button {
      background-color: #3498db;
      color: white;
      padding: 10px 20px;
      border: none;
      margin-top: 20px;
      border-radius: 6px;
      cursor: pointer;
    }
    button:hover {
      background-color: #2980b9;
    }
    .success {
      color: green;
      font-weight: bold;
    }
    .stats {
      margin-top: 15px;
      font-size: 14px;
      color: #2c3e50;
    }
  </style>
</head>
<body>

<div class="container">
  <h1>ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­ØµÙˆÙ† Ø§Ù„Ø®Ù…Ø³Ø©</h1>

  <label for="startDate">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡:</label>
  <input type="date" id="startDate">

  <label for="dailyPages">Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙˆØ¬Ù‡ ÙŠÙˆÙ…ÙŠØ§Ù‹:</label>
  <select id="dailyPages">
    <option value="1">1 ÙˆØ¬Ù‡</option>
    <option value="2">2 ÙˆØ¬Ù‡</option>
    <option value="3">3 Ø£ÙˆØ¬Ù‡</option>
  </select>

  <button onclick="generatePlan()">Ø¹Ø±Ø¶ Ø®Ø·Ø© Ø§Ù„ÙŠÙˆÙ…</button>

  <div class="output" id="planOutput" style="display:none">
    <h2>Ø®Ø·Ø© Ø§Ù„ÙŠÙˆÙ…:</h2>
    <p><strong>Ø§Ù„Ø­ÙØ¸ Ø§Ù„Ø¬Ø¯ÙŠØ¯:</strong> <span id="newSave"></span></p>
    <p><strong>Ù…Ø±Ø§Ø¬Ø¹Ø© Ù‚Ø±ÙŠØ¨Ø©:</strong> <span id="recentReview"></span></p>
    <p><strong>Ù…Ø±Ø§Ø¬Ø¹Ø© Ù…ØªÙˆØ³Ø·Ø©:</strong> <span id="midReview"></span></p>
    <p><strong>Ù…Ø±Ø§Ø¬Ø¹Ø© Ø¨Ø¹ÙŠØ¯Ø©:</strong> <span id="longReview"></span></p>

    <button onclick="markDone()">âœ” ØªÙ… Ø§Ù„Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„ÙŠÙˆÙ…</button>
    <p id="doneMsg" class="success"></p>
    <div class="stats" id="progressStats"></div>
  </div>
</div>

<script>
  function generatePlan() {
    const startDateInput = document.getElementById("startDate").value;
    if (!startDateInput) {
      alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡.");
      return;
    }

    const startDate = new Date(startDateInput);
    const today = new Date();
    const dailyPages = parseInt(document.getElementById("dailyPages").value);
    const daysDiff = Math.floor((today - startDate) / (1000 * 60 * 60 * 24));

    if (daysDiff < 0) {
      alert("ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠÙƒÙˆÙ† ÙÙŠ Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„.");
      return;
    }

    // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ LocalStorage
    localStorage.setItem("hisoun5_startDate", startDateInput);
    localStorage.setItem("hisoun5_dailyPages", dailyPages);

    const pageFrom = daysDiff * dailyPages + 1;
    const pageTo = pageFrom + dailyPages - 1;

    document.getElementById("newSave").innerText = `Ù…Ù† Ø§Ù„ÙˆØ¬Ù‡ ${pageFrom} Ø¥Ù„Ù‰ ${pageTo}`;
    document.getElementById("recentReview").innerText = `Ù…Ù† Ø§Ù„ÙˆØ¬Ù‡ ${Math.max(1, pageFrom - dailyPages)} Ø¥Ù„Ù‰ ${pageFrom - 1}`;
    document.getElementById("midReview").innerText = `Ù…Ù† Ø§Ù„ÙˆØ¬Ù‡ ${Math.max(1, pageFrom - 7)} Ø¥Ù„Ù‰ ${Math.max(1, pageFrom - 1)}`;
    document.getElementById("longReview").innerText = `Ù…Ù† Ø§Ù„ÙˆØ¬Ù‡ ${Math.max(1, pageFrom - 20)} Ø¥Ù„Ù‰ ${Math.max(1, pageFrom - 10)}`;

    document.getElementById("planOutput").style.display = "block";
    updateProgress(daysDiff);
  }

  function markDone() {
    const todayKey = new Date().toISOString().split("T")[0];
    let completedDays = JSON.parse(localStorage.getItem("hisoun5_doneDays") || "[]");

    if (!completedDays.includes(todayKey)) {
      completedDays.push(todayKey);
      localStorage.setItem("hisoun5_doneDays", JSON.stringify(completedDays));
      document.getElementById("doneMsg").innerText = "âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„ÙŠÙˆÙ…ØŒ Ø£Ø­Ø³Ù†Øª!";
    } else {
      document.getElementById("doneMsg").innerText = "â—Ù„Ù‚Ø¯ Ø³Ø¬Ù„Øª Ø§Ù„Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„ÙŠÙˆÙ… Ø¨Ø§Ù„ÙØ¹Ù„.";
    }

    updateProgress();
  }

  function updateProgress(currentDay = null) {
    const completedDays = JSON.parse(localStorage.getItem("hisoun5_doneDays") || "[]");
    const totalDays = currentDay !== null ? currentDay + 1 : completedDays.length;
    const completed = completedDays.length;
    const percent = Math.round((completed / totalDays) * 100);

    document.getElementById("progressStats").innerText =
      `ğŸ“… Ø£ÙŠØ§Ù… Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²: ${completed} Ù…Ù† Ø£ØµÙ„ ${totalDays} ÙŠÙˆÙ… (${percent}Ùª)`;
  }

  // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø¹Ù†Ø¯ Ø§Ù„Ø¯Ø®ÙˆÙ„
  window.onload = () => {
    const savedStart = localStorage.getItem("hisoun5_startDate");
    const savedPages = localStorage.getItem("hisoun5_dailyPages");

    if (savedStart) document.getElementById("startDate").value = savedStart;
    if (savedPages) document.getElementById("dailyPages").value = savedPages;
  };
</script>

</body>
</html>
